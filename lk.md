
Данный документ абстрактно описывает сценарии использования сайта. 
Цели:
- Описание основных возможностей и ограничений
- Описание потока взаимодействия
- Определение терминов

Документ не описывает тех. особенности и формат передачи данных.

# Термины
- ЛК - личный кабинет - основная система сайта
- Backend (бэкенд) - серверная часть сайта, отвечающая за основную логику и работу с БД
- Fronted (фронтенд) - клиентская часть сайта с помощью которой пользователи взаимодействую с бэкендом
- API - канал между фронтом и бэком.
- Endpoint (эндпоинт, конечная точка) - Путь ресурса в API, относительного базового адреса. Пример: `/auth/login`. Полная ссылка: `api.pzstories.ru/v1/auth/login` 
- Персонаж - сущность в игре.
- Аутентификация - процесс входа в аккаунт
- Авторизация - процесс подтверждения прав доступа к ресурсу
- Токен сессии - токен доступа для подтверждения пользователя при запросах после входа
- 2FA - двухфакторная аутентификация
- TOTP - алгоритм одноразовых паролей (Google Authenticator).
# Регистрация
Регистрация осуществляется по почте и паролю.
Затем пользователю нужно подтвердить почту, введя код с почты или перейдя по ссылке.
> [!NOTE]
>Аккаунт без активации может лишь зайти в аккаунт, удалить аккаунт и всё.

После подтверждения почты, пользователь автоматически проходит аутентификацию, ему выдается токен и открывается стандартный доступ к личному кабинету.
# Вход
Отправка email + password
При наличии у пользователя 2FA пользователю предстоит пройти этот этап.
Вместе с этим сервер присылает временный токен для дальнейшей идентификации.

При множестве подключённых вариантов нужно выбрать каким способ пройти его. 
Подробнее о возможных типах в [2FA](#2FA).  


Далее серверу отправляется, выбранный тип 2ФА и токен.
> [!NOTE]
> 
> Выбор типа нужен для того чтобы сервер отправил, по необходимости нужные данные в сторонние сервисы.

После пользователь вводит код из 2ФА и сервер выдаёт ему токен сессии.
Далее пользователю должен быть показан базовый экран ЛК.

# 2FA
Форматы прохождения 2ФА:
- Почта
- TOTP
- Телеграм
- Коды восстановления?
## Почта
При добавлении способа на почту будет отправлен код. Больше тут нечего сказать.
## TOTP
Пользователю показывается QR Код и ниже код для добавления в ручную.
## Телеграм 
В личном кабинете у пользователя генерируется специальная ссылка в бота. После связки аккаунтов пользователю так же нужно будет на сайте ввести код.
## Коды восстановления
Нужны в случае утери доступа к 2ФА. Является дополнением для удобства пользователей.
# Аутентификация 
При запросах к серверу клиентское приложение должно отправлять токен сессии, для подтверждения личности пользователя.

> [!IMPORTANT]
> Токены будут передаваться в виде cookie с флагами для безопасности

При выходе из аккаунта токен сессии удаляется и не является больше действительным

## Сессии
Пользователь может зайти в аккаунт с нескольких устройств, но при повторном входе с устройства для которого уже существует сессия, то прошлая будет деактивироваться.

Для обеспечения безопасности пользователь может самостоятельно завершить сессии с других устройств. Но может это сделать только с устройства регистрации или доверенного устройства.

# Личный кабинет
## Общая структура
Содержание навигационной строки:
- Слева: Логотип
- По середине:
	- Правила
	- Информация о проекте
	- Фракции
- Справа: Имя пользователя с выпадающим меню
```
[LOGO]    Правила    О проекте  Фракции  Донат  {логин} ▾
```


В футере (снизу):
- Copyright
- Пользовательское соглашение
- Политика конфиденциальности
- Карта сайта (то же самое что и пункты в нав баре)
- Ссылки на сообщество
- Контакты для связи
## Базовая страница
На базовой странице у пользователя отображается списком ники персонажей
> [!TIP]
> В будущем было бы славно добавить "иллюстрацию персонажа"

Персонажей можно разделить на секции:
- Активные
- Удалённые / Заблокированные
- Убитые

При клике на персонажа будет открываться окно [персонажа](#Страница-персонажа)
## Страница персонажа
На ней выводим:
- Имя персонажа
- Последний вход
- Если уровень доступа больше игрока то добавляем эти данные
- Статистику персонажа (в будущем):
	- Здоровье
	- Сколько зомби убито
	- Cколько игроков убито
	- Сколько отыграно
	- Уровень навыков
	- Профессия
	- Вес
	- Перки
- Фракция (требуются уточнения)
- Список активных наказаний
	- Кнопка для просмотра всех наказаний

Кнопки:
- Удалить персонажа
- Сменить пароль / имя

